<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:tx="http://www.springframework.org/schema/tx" xmlns:aop="http://www.springframework.org/schema/aop"
	xmlns:jdbc="http://www.springframework.org/schema/jdbc" xmlns:util="http://www.springframework.org/schema/util"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="
    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
    http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc-3.0.xsd
    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
    http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
    http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd">

	<context:property-placeholder location="classpath:/META-INF/${property.file}" />


	<bean id="jettyServer" class="org.eclipse.jetty.server.Server"
		init-method="start" destroy-method="stop">
		<property name="threadPool">
			<bean id="ThreadPool" class="org.eclipse.jetty.util.thread.QueuedThreadPool">
				<property name="minThreads" value="200" />
				<property name="maxThreads" value="200" />
			</bean>
		</property>
		<property name="connectors">
			<list>
				<bean id="Connector" class="org.eclipse.jetty.server.nio.SelectChannelConnector">
					<property name="port" value="${remoting.jetty.port}" />
				</bean>
			</list>
		</property>
		<property name="handler">
			<bean id="handlers" class="org.eclipse.jetty.server.handler.HandlerCollection">
				<property name="handlers">
					<list>
						<ref bean="jettyContexts" />
						<bean id="defaultHandler" class="org.eclipse.jetty.server.handler.DefaultHandler" />
					</list>
				</property>
			</bean>
		</property>
	</bean>

	<bean id="remotingHandler" class="org.eclipse.jetty.servlet.ServletHandler">
		<property name="servlets">
			<list>
				<bean id="remotingServletHolder" class="org.eclipse.jetty.servlet.ServletHolder">
					<property name="name" value="remotingServlet" />
					<property name="servlet">
						<bean id="remotingServlet" class="org.springframework.web.servlet.DispatcherServlet">
							<property name="contextConfigLocation"
								value="classpath:/META-INF/spring/application-service.xml" />
						</bean>
					</property>
				</bean>
			</list>
		</property>
		<property name="servletMappings">
			<list>
				<bean id="openApiServletMapping" class="org.eclipse.jetty.servlet.ServletMapping">
					<property name="servletName" value="remotingServlet" />
					<property name="pathSpec" value="/remoting/*" />
				</bean>
			</list>
		</property>
	</bean>

	<bean id="jettyContexts"
		class="org.eclipse.jetty.server.handler.ContextHandlerCollection">
		<property name="handlers">
			<list>
				<bean id="remotingHandlerContext" class="org.eclipse.jetty.servlet.ServletContextHandler">
					<property name="servletHandler" ref="remotingHandler" />
				</bean>
			</list>
		</property>
	</bean>

</beans>